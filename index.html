<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å®åœ‹/æ˜“ä¸åœ°æ”¿ - å°ˆæ¥­æ–‡ä»¶ç”Ÿæˆç³»çµ±</title>
    
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
    
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;600;700;900&family=Inter:wght@300;400;500;600&family=Noto+Sans+TC:wght@300;400;500;700&display=swap" rel="stylesheet">

    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'hg-blue': '#005f86',
                        'hg-red': '#ce2626',
                        'hg-dark': '#2c2c2c',
                    },
                    fontFamily: {
                        sans: ['"Inter"', '"Noto Sans TC"', 'sans-serif'],
                        serif: ['"Noto Serif TC"', 'serif'],
                    },
                    boxShadow: {
                        'glass': '0 8px 32px 0 rgba(31, 38, 135, 0.15)',
                    }
                }
            }
        }
    </script>

    <style>
        /* === UI èƒŒæ™¯é¢¨æ ¼ (Glassmorphism) === */
        body {
            background-color: #e0e5ec;
            background-image: 
                radial-gradient(at 0% 0%, hsla(213, 50%, 85%, 1) 0, transparent 50%), 
                radial-gradient(at 100% 100%, hsla(220, 39%, 80%, 1) 0, transparent 50%);
            background-attachment: fixed;
            font-family: 'Inter', 'Noto Sans TC', sans-serif;
            overflow: hidden; 
            color: #333;
        }

        /* ç£¨ç ‚ç»ç’ƒé¢æ¿ */
        .glass-panel {
            background: rgba(255, 255, 255, 0.65);
            backdrop-filter: blur(20px);
            -webkit-backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255, 255, 255, 0.5);
            border-right: 1px solid rgba(255, 255, 255, 0.5);
        }

        /* A4 ç´™å¼µ (é è¦½å€) */
        .a4-paper {
            width: 210mm;
            min-height: 297mm;
            background: white;
            margin: 0 auto;
            position: relative;
            box-shadow: 0 30px 60px -12px rgba(50, 50, 93, 0.25), 0 18px 36px -18px rgba(0, 0, 0, 0.3);
            display: flex;
            flex-direction: column;
            padding: 15mm 20mm;
            box-sizing: border-box;
            transition: transform 0.3s ease;
        }

        /* === åˆ—å°æ¨¡å¼ (Print Mode) === */
        @media print {
            body * { visibility: hidden; }
            body { background: white !important; overflow: visible !important; }
            #document-root, #document-root * { visibility: visible; }
            
            #document-root {
                position: fixed;
                left: 0;
                top: 0;
                width: 100%;
                margin: 0 !important;
                padding: 15mm !important;
                box-shadow: none !important;
                z-index: 9999;
            }
            header, aside { display: none !important; }
            * { -webkit-print-color-adjust: exact !important; print-color-adjust: exact !important; }
        }
    </style>
</head>
<body class="h-screen flex flex-col">

    <header class="glass-panel h-16 flex items-center justify-between px-6 shrink-0 z-50 relative shadow-sm">
        <div class="flex items-center gap-3">
            <div class="w-8 h-8 rounded-lg bg-gray-800 flex items-center justify-center text-white font-bold shadow-md">N</div>
            <h1 class="font-semibold text-gray-700">Nexus Document <span class="text-xs text-gray-500 font-normal ml-2">Enterprise Edition</span></h1>
        </div>
        <div class="flex gap-3">
            <button onclick="window.print()" class="px-4 py-2 bg-gray-800 hover:bg-black text-white rounded-lg text-sm font-medium transition shadow-lg flex items-center gap-2">
                ğŸ–¨ï¸ åˆ—å° / å­˜PDF
            </button>
            <button onclick="downloadJPG()" class="px-4 py-2 bg-white hover:bg-gray-50 text-gray-700 border border-gray-200 rounded-lg text-sm font-medium transition shadow-sm flex items-center gap-2">
                ğŸ–¼ï¸ å­˜ JPG
            </button>
        </div>
    </header>

    <div class="flex-1 flex overflow-hidden">
        
        <aside class="w-full md:w-[350px] glass-panel flex flex-col z-40 h-full relative border-r border-white/40">
            <div class="p-5 border-b border-gray-200/50 font-bold text-gray-600 flex items-center gap-2">
                <span>âš™ï¸</span> åƒæ•¸è¨­å®š
            </div>
            
            <div class="flex-1 overflow-y-auto p-6 space-y-6">
                <div class="space-y-4">
                    <div>
                        <label class="block text-xs font-bold text-gray-400 mb-1">ä¸»æ¨™é¡Œ</label>
                        <input type="text" id="input-title" oninput="updateContent()" class="w-full p-2 bg-white/50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-gray-400 outline-none text-sm" value="ä¸å‹•ç”¢è²·è³£å¥‘ç´„æ³¨æ„äº‹é …">
                    </div>
                    <div>
                        <label class="block text-xs font-bold text-gray-400 mb-1">å‰¯æ¨™é¡Œ / æ—¥æœŸ</label>
                        <input type="text" id="input-subtitle" oninput="updateContent()" class="w-full p-2 bg-white/50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-gray-400 outline-none text-sm" value="ä¸­è¯æ°‘åœ‹ 115 å¹´ 1 æœˆ 2 æ—¥ | æ¡ˆä»¶ç·¨è™Ÿï¼šHG-20260102">
                    </div>
                </div>

                <div class="h-px bg-gray-300 w-full"></div>

                <div>
                    <label class="block text-xs font-bold text-gray-400 mb-1">å…§æ–‡å…§å®¹</label>
                    <textarea id="input-content" oninput="updateContent()" rows="12" class="w-full p-3 bg-white/50 border border-gray-200 rounded-lg focus:ring-2 focus:ring-gray-400 outline-none leading-relaxed text-sm" placeholder="è«‹è¼¸å…¥å…§å®¹...">èŒ²èªªæ˜æœ¬æ¬¡ä¸å‹•ç”¢äº¤æ˜“ä¹‹é‡è¦äº‹é …å¦‚ä¸‹ï¼š

ä¸€ã€ç”¢æ¬Šèª¿æŸ¥ï¼š
æœ¬æ‰€å·²å®ŒæˆåœŸåœ°åŠå»ºç‰©ç™»è¨˜ç°¿è¬„æœ¬ä¹‹èª¿é–±ï¼Œç¢ºèªç”¢æ¬Šæ¸…æ¥šï¼Œç„¡é™åˆ¶ç™»è¨˜æƒ…äº‹ã€‚

äºŒã€ç¨…è²»è² æ“”ï¼š
1. åœŸåœ°å¢å€¼ç¨…ç”±è³£æ–¹è² æ“”ã€‚
2. å¥‘ç¨…ã€å°èŠ±ç¨…ã€ç™»è¨˜è¦è²»ç”±è²·æ–¹è² æ“”ã€‚
3. åœ°æ”¿å£«ä»£è¾¦è²»ç”¨ä¾ç…§é›™æ–¹å”è­°è¾¦ç†ã€‚

ä¸‰ã€ç‰¹åˆ¥ç´„å®šï¼š
æœ¬æ¡ˆé è¨ˆæ–¼ç°½ç´„å¾Œ 45 æ—¥å…§å®Œæˆå®Œç¨…åŠéæˆ¶æ‰‹çºŒï¼Œè«‹é›™æ–¹å‚™å¦¥ç›¸é—œè­‰ä»¶ã€‚

æ˜“ä¸åœ°æ”¿èˆ‡å®åœ‹åœ°æ”¿åœ˜éšŠ æ•¬ä¸Š</textarea>
                </div>
                
                <div class="p-4 bg-white/40 rounded-xl border border-white/60">
                     <div class="flex justify-between items-center mb-3">
                        <span class="text-xs font-bold text-gray-500">ğŸ“Š åœ–è¡¨æ•¸æ“šèˆ‡é …ç›®</span>
                        <input type="checkbox" id="show-chart" onchange="toggleChart()" checked class="accent-gray-700">
                    </div>
                    
                    <div class="flex items-center gap-2 mb-2">
                        <div class="w-3 h-3 rounded-full bg-hg-blue shrink-0"></div> <input type="text" id="chart-label-1" value="è‡ªä½éœ€æ±‚" placeholder="é …ç›®åç¨±" oninput="updateChartData()" class="w-2/3 p-1.5 border border-gray-200 rounded text-xs focus:ring-1 focus:ring-hg-blue outline-none">
                        <input type="number" id="chart-val-1" value="70" oninput="updateChartData()" class="w-1/3 p-1.5 text-center border border-gray-200 rounded text-xs focus:ring-1 focus:ring-hg-blue outline-none">
                    </div>

                    <div class="flex items-center gap-2">
                        <div class="w-3 h-3 rounded-full bg-hg-red shrink-0"></div> <input type="text" id="chart-label-2" value="æŠ•è³‡éœ€æ±‚" placeholder="é …ç›®åç¨±" oninput="updateChartData()" class="w-2/3 p-1.5 border border-gray-200 rounded text-xs focus:ring-1 focus:ring-hg-red outline-none">
                        <input type="number" id="chart-val-2" value="30" oninput="updateChartData()" class="w-1/3 p-1.5 text-center border border-gray-200 rounded text-xs focus:ring-1 focus:ring-hg-red outline-none">
                    </div>
                    
                    <p class="text-[10px] text-gray-400 mt-2 text-right">* æ•¸å€¼å»ºè­°ç¸½å’Œç‚º 100</p>
                </div>
            </div>
        </aside>

        <main class="flex-1 overflow-auto p-8 flex justify-center relative">
            
            <div id="document-root" class="a4-paper">
                
                <div class="flex items-end justify-between pb-4 border-b-[5px] border-gray-600 mb-8">
                    <div class="flex items-center gap-5">
                        <img src="æ˜“ä¸logo-01.jpg" alt="æ˜“ä¸åœ°æ”¿" class="h-[60px] object-contain" onerror="this.style.display='none'">
                        <div class="h-[40px] w-px bg-gray-400"></div>
                        <img src="å®åœ‹åœ°æ”¿å°é¢.jpg" alt="å®åœ‹åœ°æ”¿" class="h-[50px] object-contain" onerror="this.style.display='none'">
                    </div>

                    <div class="text-right">
                        <h1 class="text-3xl font-bold text-hg-dark tracking-tight font-serif mb-1">å®åœ‹åœ°æ”¿ æ˜“ä¸åœ°æ”¿</h1>
                        <h2 class="text-sm text-gray-600 font-bold tracking-[0.2em]">å°ˆæ¥­åœ°æ”¿åœ˜éšŠ</h2>
                        <p class="text-[10px] text-gray-400 tracking-[0.15em] uppercase mt-0.5">Professional Land Agent</p>
                    </div>
                </div>

                <div class="text-center mb-10">
                    <h1 id="preview-title" class="text-[26pt] font-serif font-bold text-gray-900 mb-3 tracking-wide">ä¸å‹•ç”¢è²·è³£å¥‘ç´„æ³¨æ„äº‹é …</h1>
                    <div class="flex justify-center items-center gap-2 text-sm text-gray-600 font-sans">
                        <span id="preview-subtitle">ä¸­è¯æ°‘åœ‹ 115 å¹´ 1 æœˆ 2 æ—¥ | æ¡ˆä»¶ç·¨è™Ÿï¼šHG-20260102</span>
                    </div>
                </div>

                <div id="preview-content" class="text-justify leading-[2.2] text-gray-900 font-serif whitespace-pre-wrap text-[12pt] px-2 flex-1">
                    </div>

                <div id="chart-container" class="mt-4 mb-8 px-10 flex flex-col items-center">
                    <div class="w-full max-w-[300px] h-[220px] relative"> <canvas id="myChart"></canvas>
                    </div>
                </div>

                <div class="footer-section mt-auto border-t border-gray-300 pt-3 text-center">
                    <p class="font-bold text-gray-800 text-sm mb-1">å®åœ‹åœ°æ”¿ / æ˜“ä¸åœ°æ”¿å£«äº‹å‹™æ‰€</p>
                    <p class="text-[9pt] text-gray-500 font-sans">
                        åœ°å€ï¼šå°å—å¸‚å®‰å®šå€ (ç¯„ä¾‹åœ°å€) | é›»è©±ï¼š(06) 123-4567 | çµ±ç·¨ï¼š12345678
                    </p>
                </div>

            </div>
        </main>
    </div>

    <script>
        let myChart;
        
        window.onload = function() {
            initChart();
            updateContent();
        };

        // åœ–è¡¨åˆå§‹åŒ–
        function initChart() {
            const ctx = document.getElementById('myChart').getContext('2d');
            
            // åˆå§‹å€¼
            const label1 = document.getElementById('chart-label-1').value;
            const label2 = document.getElementById('chart-label-2').value;
            const val1 = parseInt(document.getElementById('chart-val-1').value) || 0;
            const val2 = parseInt(document.getElementById('chart-val-2').value) || 0;

            myChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: [label1, label2], // ä½¿ç”¨è®Šæ•¸
                    datasets: [{
                        data: [val1, val2],
                        backgroundColor: ['#005f86', '#ce2626'], // å“ç‰Œè—ã€å“ç‰Œç´…
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { 
                        legend: { 
                            display: true, // é–‹å•Ÿåœ–ä¾‹
                            position: 'bottom',
                            labels: {
                                font: {
                                    family: "'Noto Serif TC', serif",
                                    size: 12
                                },
                                usePointStyle: true, // ä½¿ç”¨åœ“é»åœ–ä¾‹
                                padding: 20
                            }
                        } 
                    },
                    cutout: '65%' // ç”œç”œåœˆåšåº¦
                }
            });
        }

        // å…§å®¹æ›´æ–°
        function updateContent() {
            document.getElementById('preview-title').textContent = document.getElementById('input-title').value;
            document.getElementById('preview-subtitle').textContent = document.getElementById('input-subtitle').value;
            document.getElementById('preview-content').textContent = document.getElementById('input-content').value;
        }

        // åœ–è¡¨æ•¸æ“šèˆ‡æ–‡å­—æ›´æ–°
        function updateChartData() {
            // æŠ“å–æ–‡å­—
            const label1 = document.getElementById('chart-label-1').value || 'é …ç›® 1';
            const label2 = document.getElementById('chart-label-2').value || 'é …ç›® 2';
            
            // æŠ“å–æ•¸å€¼
            const val1 = parseInt(document.getElementById('chart-val-1').value) || 0;
            const val2 = parseInt(document.getElementById('chart-val-2').value) || 0;
            
            // æ›´æ–° Chart.js
            myChart.data.labels = [label1, label2];
            myChart.data.datasets[0].data = [val1, val2];
            myChart.update();
        }

        function toggleChart() {
            const show = document.getElementById('show-chart').checked;
            document.getElementById('chart-container').style.display = show ? 'flex' : 'none';
        }

        // JPG ä¸‹è¼‰
        function downloadJPG() {
            const element = document.getElementById('document-root');
            const originalShadow = element.style.boxShadow;
            element.style.boxShadow = 'none'; 
            
            html2canvas(element, { scale: 2, useCORS: true }).then(canvas => {
                const link = document.createElement('a');
                link.download = 'åœ°æ”¿æ–‡ä»¶.jpg';
                link.href = canvas.toDataURL('image/jpeg', 0.9);
                link.click();
                element.style.boxShadow = originalShadow;
            }).catch(e => {
                alert("åœ–ç‰‡åŒ¯å‡ºå—é˜»ï¼Œè«‹ä½¿ç”¨åˆ—å°åŠŸèƒ½å¦å­˜ PDF");
            });
        }
    </script>
</body>
</html>